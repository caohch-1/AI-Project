# AI for Tetris

The code for project "AI for Tetris" in CS181, ShanghaiTech University.

## Introduction

\TBD

### **What task does our code (method) solve?**

we design three AI agents for  Tetris,  including  heuristics  algorithm,  genetic-beam  search,and  deep  Q-learning,  and  conduct  a  comprehensive  evaluation. Experiments  show  that  (TBD)has  the  best  performance,  which arrives(T BD)for  average  scores,(T BD)for  average  tetrominoes,  and(T BD)for  average  cleared  lines.



## Code Structure

```
|--TetrisAI/
|   |--src/
|      |--arg_parser.py		/* Files 
|      |--tetris.py     /* Files for the implementation of Tetris game
|      |--arg_parser_heur.py    /*Files for the implementation of arguments used to test parameters in heuristic agent
|   |--trained_models$K$/
|      |--tetris		/* Torch Model of MLP$K$
|   |--img/      /* Folder for images
|   |--genetic.py                /* Files for applying Genetic-Beam Search algorithm
|   |--GeneticTrain.py           /* Files for training best chromosomes for Tetris game
|   |--GeneticTest.py            /*  Files for testing scores for Tetris game
|   |--BestRunner.py             /* Files for demo to run Tetris game with the best chromosomes trained.
|   |--BestChromosome_CFP.txt    /* The trained chromosomes generated by GeneticTrain.py
|   |--BestChromosome_CGBP.txt   /* The trained chromosomes generated by GeneticTrain.py
|   |--heuristic.py    /*File for heuristic agent
|   |--QLearningTrain.py    /* Train DQN Agent 
|   |--QLearningTest.py    /* Test DQN Agent
```



### Notations and Definitions

The notations used throughtout following sections are shown in Table.â… .

![table1](https://github.com/caohch-1/AI-Project/blob/main/DQN/img/table1.png)

Before diving into the detail of three AI agents, we briefly describe three definition used in the following algorithms.

__Holes__. We define an empty position as a hole if it is surrounded by non-zero numbers or the border of the board.

__Block height__. The distance from the lowest non-zero number to the highest non-zero number of each column is the height of the column.

__Bumpiness.__ The list of difference between the column heights of two adjacent columns.

![picture1](https://github.com/caohch-1/AI-Project/blob/main/DQN/img/picture1.png)



### Heuristic Agent

This agent uses 8 features to calculate a score for each action and choose the best action with the highest score to execute.

- Usage

```
python heuristic_agent.py
```



### Genetic-Beam Agent

The Genetic-Beam agent converts the solution process into a process similar to the crossover and mutation of the chromosomes in biological evolution. 

- Usage

```
python GeneticTrain.py
python BestRunner.py
```



### Q-Learning Agent

An reinforcement learning Agent using Deep Q-Network (DQN

- Usage

```
# Make sure saved_path is a existing directory
python QLearningTrain.py --model=32 --save_interval=500 --saved_path=trained_models32 --gui=1 # For detail See src/arg_parser.py
python QLearningTest.py --saved_path=trained_models32 --gui=1 --test_num=500 # # For detail See src/arg_parser.py
```



## Evaluation

**Experiment settings.**

To cater for the needs of our methods, we modify  and integrate some Tetris implementations on GitHub. To evaluate the three methods of Tetris agent, we set $N=10$, $M=20$ (i.e., a $N\times M$ grid) as our test environment.



In order to evaluate the efficiency of methods implementing Tetris agent, we choose three scoring criteria to quantify the performance of different methods. To see the full evaluation, please read our report article.

## Conclusion

TBD
